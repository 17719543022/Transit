//////////////////////////////////////////////////////////////////////////////////////////////
/// COPYRIGHT NOTICE  
/// Copyright(c)2018,中科院重庆研究院智能安全技术研究中心  （版权声明）  
/// All rights reserved.  
/// \file IDCardSDK.h 
/// \brief 人证比对SDK
///
/// \author plusone_chen 
/// \version V1.0(main.min，主版本.分版本格式)  
/// \date 2018/6/10 
//////////////////////////////////////////////////////////////////////////////////////////////

#ifndef FACEIDENTIFYSDK_H
#define FACEIDENTIFYSDK_H

#include "ParamDefine.h"

#ifdef FACEIDENTIFYSDK_EXPORTS
	#define FCFIAPI  __declspec(dllexport)
#else
	#define FCFIAPI
#endif

#ifdef __cplusplus
extern "C"{
#endif	

	/* 功能： 初始化参数设置
	** 参数：
	**		pSDKParam ，初始化参数，[IN]
	**		pOptParam , 人脸寻优参数结构体, [IN]
	** 返回值：
	**		0， 成功；其他，错误码 
	*/
	FCFIAPI int CoreFIInit(const FISDKParam* pSDKParam = NULL, const OptimumParam* pOptParam = NULL);
	
	/* 功能： 释放对象内存
	*/
	FCFIAPI void CoreFIRelease();

	/*功能：设置视频检测回调函数
	*/
	FCFIAPI void CoreFISetVideoDetectCB(VideoDetectCB videoDetectCB, void* userData);

	/*功能：设置身份证信息识别回调 和 读卡器状态回调
	*/
	FCFIAPI void CoreFISetIDCardResponseCB(IDCardResponseCB idCardResponse, void* userData, IDCardOnlineCB idCardOnline = 0,IDCardOfflineCB idCardOffline = 0);

	/*功能：设置服务器异步调用回调
	*/
	FCFIAPI void CoreFISetRPCCB(InputIdInfoCB inputIdInfoCB, InputFligtInfoCB inputFligtInfoCB, ManualCheckCB manualCheckCB, void* userData);

	/*功能： 传入证件照做人证比对[同步]
	**参数： pIdInfo ，传入的证件照片信息， [IN]
	**		faceIdentifyResult， 人证比对结果， [OUT]
	**返回值：
	**		0，成功；其他，失败
	**说明： 不使用读卡器功能
	**		配置文件config.ini ----compareMode配置为0时做本地对比,1时调用服务器对比,2先做服务器比对若失败做本地比对
	*/
	FCFIAPI int CoreFIIdentifyInputIdInfo(IDInfos *pIdInfo, FaceIdentifyResult *faceIdentifyResult);

	/*功能： 传入证件照做人证比对[异步远程调用]
	**参数： pIdInfo ，传入的证件照片信息， [IN]
	**返回值：
	**		0，成功；其他，失败
	**说明： 不使用读卡器功能
	**		调用服务器对比 ----compareMode配置为2先做服务器比对若失败做本地比对
	*/
	FCFIAPI int CoreFIIdentifyInputIdInfoAsyn(IDInfos *pIdInfo);

	/*功能： 传入现场照视频流
	**参数： 
	**	frameIndex， 传入图像的帧序号， [IN]
	**  liveImage, 传入视频流图片数据RGB格式, [IN]
	**  liveImageLen, liveImageWidth, liveImageHeight， 传入视频流图片的字节长度、宽度、高度, [IN]
	**  faceNum,检测到的人脸个数, [OUT]
	**  facePos,人脸对应的位置信息,[OUT]
	** 返回值：
	**		 0，成功；其他，失败
	** 说明：
	**		外部申请faceNum数组大小不小于20
	*/
	FCFIAPI int CoreFIInputVideoFrame(int frameIndex,char *pImgData,int imgLen,int imgWidth,int imgHeight,int *faceNum,int facePos[][5]);

	/*功能： 安检人工通道接口[同步]
	**参数：
	**	flightInfo， 传入航班信息，[IN]
	**  nStatus, 服务返回结果，[OUT]
	**返回值：
	**		0，成功；其他，失败
	**说明：
	**
	*/
	FCFIAPI int CoreFIInputFligtInfo(const FlightInfo* flightInfo, int* nStatus);

	/*功能： 安检人工通道接口[异步]
	**参数：
	**	flightInfo， 传入航班信息，[IN]
	**  nStatus, 服务返回结果，[OUT]
	**返回值：
	**		0，成功；其他，失败
	**说明：
	**
	*/
	FCFIAPI int CoreFIInputFligtInfoAsyn(const FlightInfo* flightInfo);

	/*功能：人工放行[同步]
	**参数：
	**  pIdInfo，传入的证件照片信息， [IN]
	**  flightInfo， 传入航班信息，[IN]
	**  nStatus，服务返回结果，[OUT]
	**返回值：
	**		0，成功；其他，失败
	**说明：
	**    
	*/
	FCFIAPI int CoreFIManualCheck(int* nStatus, FlightInfo* flightInfo, const IDInfos *pIdInfo = NULL);

	/*功能：人工放行[异步]
	**参数：
	**  pIdInfo，传入的证件照片信息， [IN]
	**  flightInfo， 传入航班信息，[IN]
	**返回值：
	**		0，成功；其他，失败
	**说明：
	**    
	*/
	FCFIAPI int CoreFIManualCheckAsyn(FlightInfo* flightInfo, const IDInfos *pIdInfo = NULL);

	/*功能： 获取内部结构版本信息
	**参数： fVersion，字符串数组，[OUT]
	**返回值：
	**		0，成功；其他，失败
	**说明：
	**	外部申请不小于468个字节,其中 人脸寻优版本:32字节，人脸特征版本:200字节，人脸匹配版本：200字节，身份证阅读版本:36字节，视频解码模块版本:,视频编码模块版本:,当前SDK版本：
	*/
	FCFIAPI int CoreFIGetVersion(char *fVersion);


#ifdef __cplusplus
}
#endif

#endif




